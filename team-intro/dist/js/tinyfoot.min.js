let UISelector={footnote:".footnote",close_btn:".close-btn",checkbox:".tinyfoot-checkbox",button:"span"};class TinyFoot extends HTMLElement{static#top_element=null;constructor(){super()}connectedCallback(){this.data_text=this.textContent.trim(),this.data_group=this.getAttribute("data-group")||"",this.innerHTML=`
			<p class="footnote">
				${this.data_text}
				<button class="close-btn">&times;</button>
			</p>
			<label>
				<input type="checkbox" class="tinyfoot-checkbox">
				<span>
						<svg viewBox="0 0 6 6" preserveAspectRatio="xMinYMin"><circle r="3" cx="3" cy="3" fill="white"></circle></svg>
						<svg viewBox="0 0 6 6" preserveAspectRatio="xMinYMin"><circle r="3" cx="3" cy="3" fill="white"></circle></svg>
						<svg viewBox="0 0 6 6" preserveAspectRatio="xMinYMin"><circle r="3" cx="3" cy="3" fill="white"></circle></svg>
				</span>
			</label>
    `;var e=this.querySelector(UISelector.button);let t=this.querySelector(UISelector.footnote),o=this.querySelector(UISelector.checkbox);var n=this.querySelector(UISelector.close_btn);o.addEventListener("change",()=>{o.checked?this.show():this.unshow()}),n.addEventListener("click",()=>{this.unshow()}),t.addEventListener("mousedown",()=>{TinyFoot.top_element=t}),t.addEventListener("mouseenter",()=>{TinyFoot.top_element=t}),e.addEventListener("mouseenter",()=>{this.show()}),e.addEventListener("mouseleave",()=>{o.checked||this.unshow()})}static get top_element(){return TinyFoot.#top_element}static set top_element(e){TinyFoot.#top_element&&(TinyFoot.#top_element.style.zIndex=999),TinyFoot.#top_element=e,TinyFoot.#top_element&&(TinyFoot.#top_element.style.zIndex=1e3)}update_ui(e){var t=this.querySelector(UISelector.footnote),e=(this.querySelector(UISelector.checkbox).checked=e,t.style.zIndex=1e3,t.classList.remove("right-aligned"),t.getBoundingClientRect());e.right>window.innerWidth&&t.classList.add("right-aligned")}show(){var e=this.querySelector(UISelector.footnote);this.update_ui(!0),this.show_same_group(),this.unshow_other_groups(),TinyFoot.top_element=e}unshow(){this.update_ui(!1),this.unshow_same_group(),TinyFoot.top_element=null}show_same_group(){document.querySelectorAll(`tiny-foot[data-group="${this.data_group}"]`).forEach(e=>{e!==this&&(e.update_ui(!0),e.querySelector(UISelector.footnote).style.zIndex=999)})}unshow_same_group(){document.querySelectorAll(`tiny-foot[data-group="${this.data_group}"]`).forEach(e=>{e!==this&&e.update_ui(!1)})}unshow_other_groups(){document.querySelectorAll(`tiny-foot:not([data-group="${this.data_group}"])`).forEach(e=>{e.querySelector(UISelector.checkbox).checked=!1})}}function mousedown_handler(t){var o=document.querySelectorAll("tiny-foot");let n=!1;for(let e=0;e<o.length;e++)if(o[e].contains(t.target)){n=!0;break}if(!n)for(let e=0;e<o.length;e++)o[e].querySelector(UISelector.checkbox).checked=!1}function add_event_listeners(){document.addEventListener("mousedown",mousedown_handler)}function main(){add_event_listeners()}customElements.define("tiny-foot",TinyFoot),document.addEventListener("DOMContentLoaded",main);